(function(e,t,n){"use strict";var r="Juice",i=function(){};(function(e,n){n.prototype={play:function(){var e=this,t=e.fps;e.setup(e);e.loops=0;e.isStopped=false;setTimeout(function(){e.draw()},1e3/t)},stop:function(){this.isStopped=true},draw:function(){var e=this,t=e.frame,n=e.fps,r=e.length,i=e.maxFrames,s=e.context,o=e.cache||[];if(!t){e.frame=0}e.maxFrames=n*(r/1e3);s.clearRect(0,0,e.wFull,e.hFull);if(t in o){s.putImageData(o[t],0,0)}else{e.cache[t]=e.drawFrame()}if(++e.frame>=i){e.loops++;e.frame=0;if(e.onLoop){e.onLoop(e,e.loops)}}if(!e.isStopped){setTimeout(function(){e.draw()},1e3/n)}},drawFrame:function(){var e=this,n=e.frame,r=e.context,i=e.wFull,s=e.hFull;r.globalAlpha=e.alpha;t.each(e.points,function(){this.draw(n/e.maxFrames)});return r.getImageData(0,0,i,s)}}})(e,e.Animation=e.Animation||function(t){var n,s,o,u,a=this,f=!t?{}:t;a.cssID=!f.cssID?null:f.cssID;a.cssClass=!f.cssClass?r:f.cssClass;a.w=!f.w?50:f.w;a.h=!f.h?50:f.h;a.padding=!f.padding?0:f.padding;a.wFull=a.w+2*a.padding;a.hFull=a.h+2*a.padding;a.cache=[];a.context=!f.context?null:f.context;a.length=!f.length?1e3:f.length;a.fps=!f.fps?30:f.fps;a.alpha=!f.alpha?1:f.alpha;a.ptSize=!f.ptSize?10:f.ptSize;a.setup=!f.setup?i:f.setup;a.onSetup=!f.onSetup?i:f.onSetup;a.onLoop=!f.onLoop?i:f.onLoop;o=!f.trail?{}:f.trail;a.trail=new e.Trail(o);a.points=[];u=!f.points?[{}]:f.points;n=u.length;for(s=0;s<n;s++){a.points[s]=new e.Point(a,u[s])}return a});(function(e,t){t.prototype.draw=function(e){var t,n,r=this,i=r.trail,s=r.Animation,o=0,u=i.length/s.length/(i.points+1);for(t=0,n=i.points+1;t<n;t++){o=e-(n-t)*u;if(o<0){o=o+1}r.modifier=t/n;if(r.paths){r.path=r.paths;if(typeof r.paths==="function"){r.paths(o,r)}else if(typeof r.paths==="object"){r.paths.draw(o,r)}}else{r.step(o,this)}}};t.prototype.canFade=function(){return this.trail.fade};t.prototype.canResize=function(){return this.trail.transform};t.prototype.onDestroy=function(){if(this.Animation){this.Animation=null}};(function(e,t){t.prototype.draw=e.prototype.draw;t.prototype.canFade=e.prototype.canFade;t.prototype.canResize=e.prototype.canResize;t.prototype.onDestroy=e.prototype.onDestroy;t.prototype.render=function(e,t){var n,r,i,s=this,o=s.Animation;if(o){if(o.context){n=o.context}}e=e||0;t=t||0;r=s.ptSize||1;if(this.canResize()){r=r*this.modifier}i=r/2;if(this.canFade()){n.globalAlpha=s.alpha*s.modifier}n.fillStyle=s.color;n.beginPath();n.arc(e,t,i,0,360,false);n.fill();n.closePath()}})(t,t.Round=t.Round||function(t,n){var r=this,i=!n?{}:n;if(t){this.Animation=t}r.ptSize=i.size||t.ptSize;r.color=i.color||t.color;r.alpha=i.alpha||t.alpha;r.paths=new e.Path(t,i.paths);r.trail=!i.trail?new e.Trail(t.trail):new e.Trail(i.trail);return r});(function(e,t){t.prototype.draw=e.prototype.draw;t.prototype.canFade=e.prototype.canFade;t.prototype.canResize=e.prototype.canResize;t.prototype.onDestroy=e.prototype.onDestroy;t.prototype.render=function(e,t){var n,r,i,s=this.Animation;if(s){if(s.context){n=s.context}}e=!e?0:e;t=!t?0:t;r=!this.ptSize?1:this.ptSize;i=r/2;if(this.canResize()){r=r*this.modifier}if(this.canFade()){n.globalAlpha=this.alpha*this.modifier}n.fillStyle=this.color;n.fillRect(e+i,t+i,r,r)}})(t,t.Rect=t.Rect||function(t,n){var r=this,i=!n?{}:n;if(t){r.Animation=t}r.ptSize=i.size||t.ptSize;r.color=i.color||t.color;r.alpha=i.alpha||t.alpha;r.paths=new e.Path(t,i.paths);r.trail=!i.trail?new e.Trail(t.trail):new e.Trail(i.trail);return r})})(e,e.Point=e.Point||function(t,n){var r,i=n||{};this.type=i.type||"rect";if(this.type==="round"){r=new e.Point.Round(t,n)}else{r=new e.Point.Rect(t,n)}return r});(function(e){})(e,e.Trail=e.Trail||function(e){var t=this,n=e||{};t.length=n.length||500;t.points=n.points||10;t.fade=!n.fade?typeof n.fade==="undefined"?true:n.fade:n.fade;t.transform=!n.transform?typeof n.transform==="undefined"?false:n.transform:n.transform;return t});(function(e,t){(function(e,t){t.prototype.draw=function(e,t){var n=this,r=n.x1+(n.x2-n.x1)*e,i=n.y1+(n.y2-n.y1)*e;t.render(r,i)}})(t,t.Line=t.Line||function(e,t){var n=this,r=!t?{}:t;n.x1=r.x1||0;n.y1=!r.y1?e.h/2:r.y2;n.x2=!r.x2?e.w:r.x2;n.y2=!r.y2?e.h/2:r.y2;return this});(function(e,t){t.prototype.draw=function(e,t){var n=this,r=n.x,i=n.y,s=t.ptSize/2,o=n.r-s,u=n.start,a=n.end,f=Math.PI*(a+e*(u-a))/180;r=o*Math.sin(f)+r;i=o*Math.cos(f)+i;t.render(r,i)}})(t,t.Arc=t.Arc||function(e,t){var n=this,r=!t?{}:t;n.x=r.x||e.w/2;n.y=r.y||e.h/2;n.r=!r.r?e.w>e.h?e.w/2:e.h/2:r.r;n.start=r.start||0;n.end=r.end||360;return n});(function(e){})(t,t.Ellipse=t.Ellipse||function(e,t){return this});(function(e,t){t.prototype.draw=function(e,t){var n=this,r=n.startX,i=n.startY,s=n.endX,o=n.endY,u=n.cp1x,a=n.cp1y,f=n.cp2x,l=n.cp2y,c=(1-e)*(1-e)*(1-e),h=3*(1-e)*(1-e)*e,p=3*(1-e)*e*e,d=e*e*e,v=c*r+h*u+p*f+d*s,m=c*i+h*a+p*l+d*o;t.render(v,m)}})(t,t.Bezier=t.Bezier||function(e,t){var n=this,r=t||{};n.startX=r.startX;n.startY=r.startY;n.endX=r.endX;n.endY=r.endY;n.cp1x=r.cp1x;n.cp1y=r.cp1y;n.cp2x=r.cp2x;n.cp2y=r.cp2y;return n})})(e,e.Path=e.Path||function(t,n){var r,i=n||{},s=this;s.name=i.name||"";if(s.name==="line"){r=new e.Path.Line(t,n)}else if(s.name==="arc"){r=new e.Path.Arc(t,n)}else if(s.name==="bezier"){r=new e.Path.Bezier(t,n)}else if(s.name==="ellipse"){r=new e.Path.Ellipse(t,n)}return r});if(t){var s,o=function(e,n){var i;if(typeof n==="object"){i=t(e).data(r,n)}else{i=t(e).data(r)}return i},u=function(e){return e instanceof t},a=function(t){return t instanceof e.Animation},f=function(e){var n=t(e);n.play=function(){return n.Juice("play")};n.stop=function(){return n.Juice("stop")};return n},l=function(e,n){var r=[];e.each(function(){if(t(this).prop("tagName")!=="CANVAS"){if(n){var e=document.createElement("canvas");t(e).addClass("Juice");t(this).prepend(t(e));r.push(e)}}else{r.push(this)}});return r};(function(e){e.play=function(e){return e.Juice("play")};e.stop=function(e){return e.Juice("stop")}})(t.Juice=t.Juice||function(e){if(u(e)){return f(e)}},t);(function(e){e.methods={init:function(e){var n=l(this,true);s=n;t.each(n,function(){var n=this,r=o(n);if(!r){e.context=n.getContext("2d");o(n,new Juice.Animation(e));r=o(n);t(n).attr("height",r.hFull);t(n).attr("width",r.wFull)}});return f(n)},play:function(){var e=l(this,false);return f(t.each(e,function(){var e=o(this);if(a(e)){e.play()}}))},stop:function(){var e=l(this,false);return f(t.each(e,function(){var e=o(this);if(a(e)){e.stop()}}))}};e.play=function(e){return t(e).Juice("play")};e.stop=function(e){return t(e).Juice("stop")}})(t.fn.Juice=t.fn.Juice||function(e){var n,r=t.fn.Juice.methods;if(r[e]){n=r[e].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof e==="object"){n=r.init.apply(this,arguments)}else if(typeof e==="undefined"){n=f(this)}return n},t.fn)}})(window.Juice=window.Juice||function(){},window.jQuery)
